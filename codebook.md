# Code book
In the code book we will detail the process of obtaining data tidy

## 0 run_analysis.R
The following libraries are imported.
library(plyr)
library(dplyr)
library(data.table)

Five scripts are called sequentially to answer the questions.

1.- Merges the training and the test sets to create one data set.
source("import_data.R")

2 Extracts only the measurements on the mean and standard deviation for each measurement. 
source("extract_mean_std.R")

3 Uses descriptive activity names to name the activities in the data set
source("descriptive_activity_names.R")

4 Appropriately labels the data set with descriptive variable names
source("descriptive_variable_names.R")

5 From the data set in step 4, creates a second, independent tidy data set with the average of each variable for each activity and each subject.
source("activity_subject_mean.R")

## 1 import_data.R
**1 Merges the training and the test sets to create one data set.  
import files with fread:**
- features.txt features of X_* files
- activity_labels.txt labels of y_* files
- subject* 30 volunteers within an age bracket of 19-48 years
- *_test 30% of the volunteers was selected for generating the test data.
- *_train 70% of the volunteers was selected for generating the training data
- X_* 561-feature vector with time and frequency domain variables.
- y_* activity label.
~~~
print("import file to data frame")
features <- fread("data/features.txt")
activity_labels <- fread("data/activity_labels.txt")
subject_test <- fread("data/test/subject_test.txt", col.names = "subject")
X_test <- fread("data/test/X_test.txt", col.names = features$V2)
y_test <- fread("data/test/y_test.txt", col.names = "activity")
subject_train <- fread("data/train/subject_train.txt", col.names = "subject")
X_train <- fread( "data/train/X_train.txt", col.names = features$V2)
y_train <- fread("data/train/y_train.txt", col.names = "activity")
~~~

**Data frames are joined by columns with "cbind". Join two dateframes in a temporary variable and join the third date frame again with "cbind".
The data frames of the test series are joined**
~~~
print("# 1 Merges the training and the test sets to create one data set.")
print("join data frame")
temp_var <- cbind(subject_test, y_test)
test_df <- cbind(temp_var, X_test)
cat("dim of test_df is: ", dim(test_df), "\n")
# The data frames of the train series are joined by column
temp_var <- cbind(subject_train, y_train)
train_df <- cbind(temp_var, X_train)
cat("dim of train_df is: ", dim(train_df), "\n")
# The data frames "train" and "test" are joined by rows.
all_df <- rbind(test_df, train_df)
cat("dim of train_df is: ", dim(all_df), "\n")
~~~
**Output of the script**
~~~
[1] "import file to data frame"
[1] "# 1 Merges the training and the test sets to create one data set."
[1] "join data frame"
dim of test_df is:  2947 563 
dim of train_df is:  7352 563 
dim of train_df is:  10299 563 
~~~

## 2 extract_mean_std.R
**2 Extracts only the measurements on the mean and standard deviation for each measurement.**  
**Select columns with "mean" or "std"**
~~~
toMatch <- c("mean", "std")
names_all <- names(all_df)
select_column <- grep(paste(toMatch,collapse="|"), names_all , 
                      ignore.case = TRUE, value = FALSE)
cat("select columns of mean_std_df is: ", "\n", select_column, "\n")
names_all[select_column]
mean_std_df <- all_df %>% select(subject, activity, names_all[select_column])
cat("dim of mean_std_df is: ", dim(mean_std_df ), "\n")
cat("# 2 Extracts only the measurements on the mean and standard deviation
      for each measurement.")
str(mean_std_df)
~~~
**Output of the script**
~~~
select columns of mean_std_df is:  
 3 4 5 6 7 8 43 44 45 46 47 48 83 84 85 86 87 88 123 124 125 126 127 128 163 164 165 166 167 168 203 204 216 217 229 230 242 243 255 256 268 269 270 271 272 273 296 297 298 347 348 349 350 351 352 375 376 377 426 427 428 429 430 431 454 455 456 505 506 515 518 519 528 531 532 541 544 545 554 557 558 559 560 561 562 563 
dim of mean_std_df is:  10299 88 
# 2 Extracts only the measurements on the mean and standard deviation
      for each measurement.Classes ‘data.table’ and 'data.frame':	10299 obs. of  88 variables:
 $ subject                             : int  2 2 2 2 2 2 2 2 2 2 ...
 $ activity                            : int  5 5 5 5 5 5 5 5 5 5 ...
 $ tBodyAcc-mean()-X                   : num  0.257 0.286 0.275 0.27 0.275 ...
 $ tBodyAcc-mean()-Y                   : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
 $ tBodyAcc-mean()-Z                   : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
 $ tBodyAcc-std()-X                    : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
 $ tBodyAcc-std()-Y                    : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
 $ tBodyAcc-std()-Z                    : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
 $ tGravityAcc-mean()-X                : num  0.936 0.927 0.93 0.929 0.927 ...
 $ tGravityAcc-mean()-Y                : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
 $ tGravityAcc-mean()-Z                : num  0.115 0.153 0.146 0.143 0.138 ...
 $ tGravityAcc-std()-X                 : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
 $ tGravityAcc-std()-Y                 : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
 $ tGravityAcc-std()-Z                 : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
 $ tBodyAccJerk-mean()-X               : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
 $ tBodyAccJerk-mean()-Y               : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
 $ tBodyAccJerk-mean()-Z               : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
 $ tBodyAccJerk-std()-X                : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
 $ tBodyAccJerk-std()-Y                : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
 $ tBodyAccJerk-std()-Z                : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
 $ tBodyGyro-mean()-X                  : num  0.11998 -0.00155 -0.04821 -0.05664 -0.05999 ...
 $ tBodyGyro-mean()-Y                  : num  -0.0918 -0.1873 -0.1663 -0.126 -0.0847 ...
 $ tBodyGyro-mean()-Z                  : num  0.1896 0.1807 0.1542 0.1183 0.0787 ...
 $ tBodyGyro-std()-X                   : num  -0.883 -0.926 -0.973 -0.968 -0.975 ...
 $ tBodyGyro-std()-Y                   : num  -0.816 -0.93 -0.979 -0.975 -0.978 ...
 $ tBodyGyro-std()-Z                   : num  -0.941 -0.968 -0.976 -0.963 -0.968 ...
 $ tBodyGyroJerk-mean()-X              : num  -0.2049 -0.1387 -0.0978 -0.1022 -0.0918 ...
 $ tBodyGyroJerk-mean()-Y              : num  -0.1745 -0.0258 -0.0342 -0.0447 -0.029 ...
 $ tBodyGyroJerk-mean()-Z              : num  -0.0934 -0.0714 -0.06 -0.0534 -0.0612 ...
 $ tBodyGyroJerk-std()-X               : num  -0.901 -0.962 -0.984 -0.984 -0.988 ...
 $ tBodyGyroJerk-std()-Y               : num  -0.911 -0.956 -0.988 -0.99 -0.992 ...
 $ tBodyGyroJerk-std()-Z               : num  -0.939 -0.981 -0.976 -0.981 -0.982 ...
 $ tBodyAccMag-mean()                  : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
 $ tBodyAccMag-std()                   : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
 $ tGravityAccMag-mean()               : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
 $ tGravityAccMag-std()                : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
 $ tBodyAccJerkMag-mean()              : num  -0.93 -0.974 -0.982 -0.983 -0.987 ...
 $ tBodyAccJerkMag-std()               : num  -0.896 -0.941 -0.971 -0.975 -0.989 ...
 $ tBodyGyroMag-mean()                 : num  -0.796 -0.898 -0.939 -0.947 -0.957 ...
 $ tBodyGyroMag-std()                  : num  -0.762 -0.911 -0.972 -0.97 -0.969 ...
 $ tBodyGyroJerkMag-mean()             : num  -0.925 -0.973 -0.987 -0.989 -0.99 ...
 $ tBodyGyroJerkMag-std()              : num  -0.894 -0.944 -0.984 -0.986 -0.99 ...
 $ fBodyAcc-mean()-X                   : num  -0.919 -0.961 -0.992 -0.993 -0.992 ...
 $ fBodyAcc-mean()-Y                   : num  -0.918 -0.964 -0.965 -0.968 -0.969 ...
 $ fBodyAcc-mean()-Z                   : num  -0.789 -0.957 -0.967 -0.967 -0.98 ...
 $ fBodyAcc-std()-X                    : num  -0.948 -0.984 -0.995 -0.996 -0.995 ...
 $ fBodyAcc-std()-Y                    : num  -0.925 -0.97 -0.974 -0.977 -0.967 ...
 $ fBodyAcc-std()-Z                    : num  -0.636 -0.942 -0.962 -0.969 -0.978 ...
 $ fBodyAcc-meanFreq()-X               : num  0.0111 0.3521 0.1804 0.0627 -0.0189 ...
 $ fBodyAcc-meanFreq()-Y               : num  0.12125 0.17455 0.13346 0.26172 -0.00998 ...
 $ fBodyAcc-meanFreq()-Z               : num  -0.5229 -0.3207 0.1827 0.1518 0.0952 ...
 $ fBodyAccJerk-mean()-X               : num  -0.9 -0.944 -0.991 -0.991 -0.991 ...
 $ fBodyAccJerk-mean()-Y               : num  -0.937 -0.969 -0.973 -0.972 -0.98 ...
 $ fBodyAccJerk-mean()-Z               : num  -0.924 -0.973 -0.972 -0.97 -0.983 ...
 $ fBodyAccJerk-std()-X                : num  -0.924 -0.962 -0.992 -0.992 -0.994 ...
 $ fBodyAccJerk-std()-Y                : num  -0.943 -0.98 -0.971 -0.975 -0.979 ...
 $ fBodyAccJerk-std()-Z                : num  -0.948 -0.981 -0.972 -0.981 -0.989 ...
 $ fBodyAccJerk-meanFreq()-X           : num  0.451 0.473 0.271 0.277 0.18 ...
 $ fBodyAccJerk-meanFreq()-Y           : num  0.1372 0.1672 -0.2722 -0.0383 -0.1392 ...
 $ fBodyAccJerk-meanFreq()-Z           : num  -0.1803 -0.2431 -0.0825 0.0218 0.1009 ...
 $ fBodyGyro-mean()-X                  : num  -0.824 -0.923 -0.973 -0.972 -0.976 ...
 $ fBodyGyro-mean()-Y                  : num  -0.808 -0.926 -0.981 -0.981 -0.98 ...
 $ fBodyGyro-mean()-Z                  : num  -0.918 -0.968 -0.972 -0.967 -0.969 ...
 $ fBodyGyro-std()-X                   : num  -0.903 -0.927 -0.973 -0.967 -0.974 ...
 $ fBodyGyro-std()-Y                   : num  -0.823 -0.932 -0.977 -0.972 -0.977 ...
 $ fBodyGyro-std()-Z                   : num  -0.956 -0.97 -0.979 -0.965 -0.97 ...
 $ fBodyGyro-meanFreq()-X              : num  0.184 0.0181 -0.4791 -0.497 -0.4275 ...
 $ fBodyGyro-meanFreq()-Y              : num  -0.0593 -0.2273 -0.2101 -0.4999 -0.2781 ...
 $ fBodyGyro-meanFreq()-Z              : num  0.4381 -0.1517 0.0493 -0.2589 -0.2913 ...
 $ fBodyAccMag-mean()                  : num  -0.791 -0.954 -0.976 -0.973 -0.978 ...
 $ fBodyAccMag-std()                   : num  -0.711 -0.96 -0.984 -0.982 -0.979 ...
 $ fBodyAccMag-meanFreq()              : num  -0.4835 0.2035 0.3425 0.3312 0.0711 ...
 $ fBodyBodyAccJerkMag-mean()          : num  -0.895 -0.945 -0.971 -0.972 -0.987 ...
 $ fBodyBodyAccJerkMag-std()           : num  -0.896 -0.934 -0.97 -0.978 -0.99 ...
 $ fBodyBodyAccJerkMag-meanFreq()      : num  -0.0354 -0.4912 0.1407 0.1486 0.4222 ...
 $ fBodyBodyGyroMag-mean()             : num  -0.771 -0.924 -0.975 -0.976 -0.977 ...
 $ fBodyBodyGyroMag-std()              : num  -0.797 -0.917 -0.974 -0.971 -0.97 ...
 $ fBodyBodyGyroMag-meanFreq()         : num  -0.0474 -0.0315 -0.1688 -0.2856 -0.3491 ...
 $ fBodyBodyGyroJerkMag-mean()         : num  -0.89 -0.952 -0.986 -0.986 -0.99 ...
 $ fBodyBodyGyroJerkMag-std()          : num  -0.907 -0.938 -0.983 -0.986 -0.991 ...
 $ fBodyBodyGyroJerkMag-meanFreq()     : num  0.0716 -0.4012 0.0629 0.1167 -0.1217 ...
 $ angle(tBodyAccMean,gravity)         : num  0.00646 -0.08349 -0.03496 -0.01707 -0.00222 ...
 $ angle(tBodyAccJerkMean),gravityMean): num  0.1629 0.0175 0.2023 0.1544 -0.04 ...
 $ angle(tBodyGyroMean,gravityMean)    : num  -0.8259 -0.4344 0.0641 0.3401 0.7367 ...
 $ angle(tBodyGyroJerkMean,gravityMean): num  0.271 0.921 0.145 0.296 -0.119 ...
 $ angle(X,gravityMean)                : num  -0.72 -0.698 -0.703 -0.699 -0.692 ...
 $ angle(Y,gravityMean)                : num  0.277 0.281 0.28 0.284 0.291 ...
 $ angle(Z,gravityMean)                : num  -0.058 -0.0839 -0.0793 -0.0771 -0.0739 ...
 - attr(*, ".internal.selfref")=<externalptr> 
~~~

## 3 descriptive_activity_names.R
**3 Uses descriptive activity names to name the activities in the data set**  
**The variable "activity" is converted from numeric to factor**
~~~
mean_std_df$activity <- as.factor(mean_std_df$activity)
mean_std_df$subject <- as.factor(mean_std_df$subject)
cat("activity is: ", class(mean_std_df$activity), "\n",
    "factor levels: ", levels(mean_std_df$activity), "\n")
mean_std_df$activity <- mapvalues(mean_std_df$activity,
                                  from = activity_labels$V1, 
                                  to = activity_labels$V2)
cat("# 3 Uses descriptive activity names to name the activities 
      in the data set")
cat("factor levels new: ", levels(mean_std_df$activity), "\n")
~~~
**Output of the script**
~~~
activity is:  factor 
 factor levels:  1 2 3 4 5 6 
# 3 Uses descriptive activity names to name the activities 
      in the data setfactor levels new:  WALKING WALKING_UPSTAIRS WALKING_DOWNSTAIRS SITTING STANDING LAYING 
~~~

## 


